<!DOCTYPE html>
<html>
    <head>
        <title>Alternative coffee display</title>
        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
        <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">        <style>
            body {
                font-family: 'Montserrat', sans-serif;
                padding: 0; 
                margin: 0;
                background-color: #002D3A;
                }

            #title {
                text-align: center;
                font-size: 7em;
                font-weight: bold;
                margin-top: 0.67em;
                margin-bottom: 0.67em;
                color: #EFECE4;
            }
            #center {
                text-align: center;
                font-size: 15em;
                color: #EFECE4;
                position: absolute;
                top: 50%;
                left: 50%;
                margin-right: -50%;
                transform: translate(-50%, -50%);
            }
            #time {
                font-size: 0.2em;
            }
            progress {
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
                width: 100%;
                height: 3em;
                align-content: center;
                position: absolute;
                bottom: 0;
            }
            progress::-webkit-progress-bar {
                background: #000;
                box-shadow: 0 2px 3px rgba(0,0,0,0.2) inset;
                border-radius: 0px;
            }
            progress::-webkit-progress-value {
                background-color: #EFECE4;
                border-radius: 10px;
            }
        </style>
    </head>
<body>
<div id="title">Cups left</div>
<div id="center">
    <div id="cups"></div>
    <div id="time">Brewed x min ago</div>
</div>
<progress id="guage" value="0" max="9"></progress>

<script>
    function update(){
        $.get( "api/", function( data ) {
            apiData = JSON.parse(data)
            console.log(apiData.cups)
            $("#guage").attr("value", apiData.cups);
            $("#cups").text(apiData.cups);
            var milliseconds = (new Date).getTime();
            var deltaT = (milliseconds/1000 - apiData.brewtime)/60;
            $("#time").text("Brewed " + Math.round(deltaT) + " min ago");
            if (apiData.brewing == 1) {
                //change text to brewing...
                $("#title").text("Brewing more...");
            }
            else {
                // normal text
                $("#title").text("Cups left");

            }
        });
    }
    update();
    setInterval(function(){ update(); }, 3000);

</script>
</body>
</html>
